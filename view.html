<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Yo-Yo 分析履歴ビューア</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f4f4f4; }
    h1 { font-size: 24px; }
    img { max-width: 600px; margin: 10px 0; display: block; }
    .result { margin-bottom: 40px; padding: 10px; background: #fff; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.2);}
  </style>
</head>
<body>
  <h1>Yo-Yo 分析履歴ビューア</h1>
  <div id="results"></div>

  <script>
    const API_BASE = "https://yoyo-backend.kajilab.dev"; // サーバーのエンドポイント
    const RESULT_ID = 1; // 確認したいデータID（必要に応じて変更）

    async function fetchResult(id) {
      const res = await fetch(`${API_BASE}/results/${id}`);
      if (!res.ok) {
        document.getElementById("results").innerHTML = "データ取得失敗";
        return;
      }
      const data = await res.json();
      renderResult(data);
    }

    function renderResult(data) {
      const container = document.getElementById("results");
      container.innerHTML = `
        <div class="result">
          <h2>記録ID: ${data.timestamp}</h2>
          <p>スコア: ${data.score.toFixed(2)}</p>
          <p>ループ数: ${data.loop_count}</p>
          <p>安定化開始ループ: ${data.stable_loop ?? 'なし'}</p>
          <p>平均ループ時間: ${data.loop_mean_duration ?? 'N/A'} 秒</p>
          <p>ループ時間標準偏差: ${data.loop_std_duration ?? 'N/A'} 秒</p>
          ${data.loop_plot ? `<h3>ループ検出グラフ</h3><img src="data:image/png;base64,${data.loop_plot}" />` : ''}
          ${data.heatmap ? `<h3>ヒートマップ</h3><img src="data:image/png;base64,${data.heatmap}" />` : ''}
          ${data.compare_plot ? `<h3>プロ比較グラフ</h3><img src="data:image/png;base64,${data.compare_plot}" />` : ''}
        </div>
      `;
    }

    fetchResult(RESULT_ID);
  </script>
</body>
</html>
